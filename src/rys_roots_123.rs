#[allow(clippy::excessive_precision, clippy::unreadable_literal)]
pub(crate) fn root123(n: usize, x: f64, roots: &mut [f64], weights: &mut [f64]) {
    const R12: f64 = 2.75255128608411E-01;
    const PIE4: f64 = 7.85398163397448E-01;
    const R22: f64 = 2.72474487139158E+00;
    const W22: f64 = 9.17517095361369E-02;
    const R13: f64 = 1.90163509193487E-01;
    const R23: f64 = 1.78449274854325E+00;
    const W23: f64 = 1.77231492083829E-01;
    const R33: f64 = 5.52534374226326E+00;
    const W33: f64 = 5.11156880411248E-03;

    let mut rt1: f64 = 0.0;
    let mut rt2: f64 = 0.0;
    let mut rt3: f64 = 0.0;
    let mut ww1: f64 = 0.0;
    let mut ww2: f64 = 0.0;
    let mut ww3: f64 = 0.0;

    if x < 3.e-7 {
        if n == 1 {
            rt1 = 0.5E+00 - x / 5.0E+00;
            ww1 = 1.0E+00 - x / 3.0E+00;
        } else if n == 2 {
            rt1 = 1.30693606237085E-01 - 2.90430236082028E-02 * x;
            rt2 = 2.86930639376291E+00 - 6.37623643058102E-01 * x;
            ww1 = 6.52145154862545E-01 - 1.22713621927067E-01 * x;
            ww2 = 3.47854845137453E-01 - 2.10619711404725E-01 * x;
        } else if n == 3 {
            rt1 = 6.03769246832797E-02 - 9.28875764357368E-03 * x;
            rt2 = 7.76823355931043E-01 - 1.19511285527878E-01 * x;
            rt3 = 6.66279971938567E+00 - 1.02504611068957E+00 * x;
            ww1 = 4.67913934572691E-01 - 5.64876917232519E-02 * x;
            ww2 = 3.60761573048137E-01 - 1.49077186455208E-01 * x;
            ww3 = 1.71324492379169E-01 - 1.27768455150979E-01 * x;
        }
    } else if x < 1. {
        if n == 1 {
            let f1 = ((((((((-8.36313918003957E-08*x+1.21222603512827E-06 )*x-
                  1.15662609053481E-05 )*x+9.25197374512647E-05 )*x-
                6.40994113129432E-04 )*x+3.78787044215009E-03 )*x-
              1.85185172458485E-02 )*x+7.14285713298222E-02 )*x-
            1.99999999997023E-01 )*x+3.33333333333318E-01;
            ww1 = (x+x)*f1+(-x).exp();
            rt1 = f1/(ww1-f1);
        } else if n == 2 {
            let f1 = ((((((((-8.36313918003957E-08*x+1.21222603512827E-06 )*x-
                  1.15662609053481E-05 )*x+9.25197374512647E-05 )*x-
                6.40994113129432E-04 )*x+3.78787044215009E-03 )*x-
              1.85185172458485E-02 )*x+7.14285713298222E-02 )*x-
            1.99999999997023E-01 )*x+3.33333333333318E-01;
            ww1 = (x+x)*f1+(-x).exp();
            rt1 = (((((((-2.35234358048491E-09*x+2.49173650389842E-08)*x-
                  4.558315364581E-08)*x-2.447252174587E-06)*x+
                4.743292959463E-05)*x-5.33184749432408E-04 )*x+
              4.44654947116579E-03 )*x-2.90430236084697E-02 )*x+
            1.30693606237085E-01;
            rt2 = (((((((-2.47404902329170E-08*x+2.36809910635906E-07)*x+
                  1.835367736310E-06)*x-2.066168802076E-05)*x-
                1.345693393936E-04)*x-5.88154362858038E-05 )*x+
              5.32735082098139E-02 )*x-6.37623643056745E-01 )*x+
            2.86930639376289E+00;
            ww2 = ((f1-ww1)*rt1+f1)*(1.0E+00+rt2)/(rt2-rt1);
            ww1 = ww1-ww2;
        } else if n == 3 {
            rt1 = ((((((-5.10186691538870E-10*x+2.40134415703450E-08)*x-
                     5.01081057744427E-07 )*x+7.58291285499256E-06 )*x-
                   9.55085533670919E-05 )*x+1.02893039315878E-03 )*x-
                 9.28875764374337E-03 )*x+6.03769246832810E-02;
            rt2 = ((((((-1.29646524960555E-08*x+7.74602292865683E-08)*x+
                 1.56022811158727E-06 )*x-1.58051990661661E-05 )*x-
               3.30447806384059E-04 )*x+9.74266885190267E-03 )*x-
             1.19511285526388E-01 )*x+7.76823355931033E-01;
            rt3 = ((((((-9.28536484109606E-09*x-3.02786290067014E-07)*x-
                 2.50734477064200E-06 )*x-7.32728109752881E-06 )*x+
               2.44217481700129E-04 )*x+4.94758452357327E-02 )*x-
             1.02504611065774E+00 )*x+6.66279971938553E+00;
            let f2 = ((((((((-7.60911486098850E-08*x+1.09552870123182E-06 )*x-
                  1.03463270693454E-05 )*x+8.16324851790106E-05 )*x-
                5.55526624875562E-04 )*x+3.20512054753924E-03 )*x-
              1.51515139838540E-02 )*x+5.55555554649585E-02 )*x-
            1.42857142854412E-01 )*x+1.99999999999986E-01;
            let e = (-x).exp();
            let f1 = ((x+x)*f2+e)/3.0E+00;
            ww1 = (x+x)*f1+e;
            let t1 = rt1/(rt1+1.0E+00);
            let t2 = rt2/(rt2+1.0E+00);
            let t3 = rt3/(rt3+1.0E+00);
            let a2 = f2-t1*f1;
            let a1 = f1-t1*ww1;
            ww3 = (a2-t2*a1)/((t3-t2)*(t3-t1));
            ww2 = (t3*a1-a2)/((t3-t2)*(t2-t1));
            ww1 = ww1-ww2-ww3;
        }
    } else if x < 3. {
        let y = x-2.0E+00;
        if n == 1 {
            let f1 = ((((((((((-1.61702782425558E-10*y+1.96215250865776E-09 )*y-
                    2.14234468198419E-08 )*y+2.17216556336318E-07 )*y-
                  1.98850171329371E-06 )*y+1.62429321438911E-05 )*y-
                1.16740298039895E-04 )*y+7.24888732052332E-04 )*y-
              3.79490003707156E-03 )*y+1.61723488664661E-02 )*y-
            5.29428148329736E-02 )*y+1.15702180856167E-01;
            ww1 = (x+x)*f1+(-x).exp();
            rt1 = f1/(ww1-f1);
        } else if n == 2 {
            let f1 = ((((((((((-1.61702782425558E-10*y+1.96215250865776E-09 )*y-
                    2.14234468198419E-08 )*y+2.17216556336318E-07 )*y-
                  1.98850171329371E-06 )*y+1.62429321438911E-05 )*y-
                1.16740298039895E-04 )*y+7.24888732052332E-04 )*y-
              3.79490003707156E-03 )*y+1.61723488664661E-02 )*y-
            5.29428148329736E-02 )*y+1.15702180856167E-01;
            ww1 = (x+x)*f1+(-x).exp();
            rt1 = (((((((((-6.36859636616415E-12*y+8.47417064776270E-11)*y-
                    5.152207846962E-10)*y-3.846389873308E-10)*y+
                  8.472253388380E-08)*y-1.85306035634293E-06 )*y+
                2.47191693238413E-05 )*y-2.49018321709815E-04 )*y+
              2.19173220020161E-03 )*y-1.63329339286794E-02 )*y+
            8.68085688285261E-02;
            rt2 = ((((((((( 1.45331350488343E-10*y+2.07111465297976E-09)*y-
                    1.878920917404E-08)*y-1.725838516261E-07)*y+
                  2.247389642339E-06)*y+9.76783813082564E-06 )*y-
                1.93160765581969E-04 )*y-1.58064140671893E-03 )*y+
              4.85928174507904E-02 )*y-4.30761584997596E-01 )*y+
            1.80400974537950E+00;
            ww2 = ((f1-ww1)*rt1+f1)*(1.0E+00+rt2)/(rt2-rt1);
            ww1 = ww1-ww2;
        } else if n == 3 {
            rt1 = (((((((( 1.44687969563318E-12*y+4.85300143926755E-12)*y-
                   6.55098264095516E-10 )*y+1.56592951656828E-08 )*y-
                 2.60122498274734E-07 )*y+3.86118485517386E-06 )*y-
               5.13430986707889E-05 )*y+6.03194524398109E-04 )*y-
             6.11219349825090E-03 )*y+4.52578254679079E-02;
            rt2 = ((((((( 6.95964248788138E-10*y-5.35281831445517E-09)*y-
                  6.745205954533E-08)*y+1.502366784525E-06)*y+
                9.923326947376E-07)*y-3.89147469249594E-04 )*y+
              7.51549330892401E-03 )*y-8.48778120363400E-02 )*y+
            5.73928229597613E-01;
            rt3 = ((((((((-2.81496588401439E-10*y+3.61058041895031E-09)*y+
                   4.53631789436255E-08 )*y-1.40971837780847E-07 )*y-
                 6.05865557561067E-06 )*y-5.15964042227127E-05 )*y+
               3.34761560498171E-05 )*y+5.04871005319119E-02 )*y-
             8.24708946991557E-01 )*y+4.81234667357205E+00;
            let f2 = ((((((((((-1.48044231072140E-10*y+1.78157031325097E-09 )*y-
                    1.92514145088973E-08 )*y+1.92804632038796E-07 )*y-
                  1.73806555021045E-06 )*y+1.39195169625425E-05 )*y-
                9.74574633246452E-05 )*y+5.83701488646511E-04 )*y-
              2.89955494844975E-03 )*y+1.13847001113810E-02 )*y-
            3.23446977320647E-02 )*y+5.29428148329709E-02;
            let e = (-x).exp();
            let f1 = ((x+x)*f2+e)/3.0E+00;
            ww1 = (x+x)*f1+e;
            let t1 = rt1/(rt1+1.0E+00);
            let t2 = rt2/(rt2+1.0E+00);
            let t3 = rt3/(rt3+1.0E+00);
            let a2 = f2-t1*f1;
            let a1 = f1-t1*ww1;
            ww3 = (a2-t2*a1)/((t3-t2)*(t3-t1));
            ww2 = (t3*a1-a2)/((t3-t2)*(t2-t1));
            ww1 = ww1-ww2-ww3;
        }
    } else if x < 5. {
        let y = x-4.0E+00;
        if n == 1 {
            let f1 = ((((((((((-2.62453564772299E-11*y+3.24031041623823E-10 )*y-
                    3.614965656163E-09)*y+3.760256799971E-08)*y-
                  3.553558319675E-07)*y+3.022556449731E-06)*y-
                2.290098979647E-05)*y+1.526537461148E-04)*y-
              8.81947375894379E-04 )*y+4.33207949514611E-03 )*y-
            1.75257821619926E-02 )*y+5.28406320615584E-02;
            ww1 = (x+x)*f1+(-x).exp();
            rt1 = f1/(ww1-f1);
        } else if n == 2 {
            let f1 = ((((((((((-2.62453564772299E-11*y+3.24031041623823E-10 )*y-
                    3.614965656163E-09)*y+3.760256799971E-08)*y-
                  3.553558319675E-07)*y+3.022556449731E-06)*y-
                2.290098979647E-05)*y+1.526537461148E-04)*y-
              8.81947375894379E-04 )*y+4.33207949514611E-03 )*y-
            1.75257821619926E-02 )*y+5.28406320615584E-02;
            ww1 = (x+x)*f1+(-x).exp();
            rt1 = ((((((((-4.11560117487296E-12*y+7.10910223886747E-11)*y-
                   1.73508862390291E-09 )*y+5.93066856324744E-08 )*y-
                 9.76085576741771E-07 )*y+1.08484384385679E-05 )*y-
               1.12608004981982E-04 )*y+1.16210907653515E-03 )*y-
             9.89572595720351E-03 )*y+6.12589701086408E-02;
            rt2 = (((((((((-1.80555625241001E-10*y+5.44072475994123E-10)*y+
                    1.603498045240E-08)*y-1.497986283037E-07)*y-
                  7.017002532106E-07)*y+1.85882653064034E-05 )*y-
                2.04685420150802E-05 )*y-2.49327728643089E-03 )*y+
              3.56550690684281E-02 )*y-2.60417417692375E-01 )*y+
            1.12155283108289E+00;
            ww2 = ((f1-ww1)*rt1+f1)*(1.0E+00+rt2)/(rt2-rt1);
            ww1 = ww1-ww2;
        } else if n == 3 {
            rt1 = ((((((( 1.44265709189601E-11*y-4.66622033006074E-10)*y+
                  7.649155832025E-09)*y-1.229940017368E-07)*y+
                2.026002142457E-06)*y-2.87048671521677E-05 )*y+
              3.70326938096287E-04 )*y-4.21006346373634E-03 )*y+
            3.50898470729044E-02;
            rt2 = ((((((((-2.65526039155651E-11*y+1.97549041402552E-10)*y+
                   2.15971131403034E-09 )*y-7.95045680685193E-08 )*y+
                 5.15021914287057E-07 )*y+1.11788717230514E-05 )*y-
               3.33739312603632E-04 )*y+5.30601428208358E-03 )*y-
             5.93483267268959E-02 )*y+4.31180523260239E-01;
            rt3 = ((((((((-3.92833750584041E-10*y-4.16423229782280E-09)*y+
                   4.42413039572867E-08 )*y+6.40574545989551E-07 )*y-
                 3.05512456576552E-06 )*y-1.05296443527943E-04 )*y-
               6.14120969315617E-04 )*y+4.89665802767005E-02 )*y-
             6.24498381002855E-01 )*y+3.36412312243724E+00;
            let f2 = ((((((((((-2.36788772599074E-11*y+2.89147476459092E-10 )*y-
                    3.18111322308846E-09 )*y+3.25336816562485E-08 )*y-
                  3.00873821471489E-07 )*y+2.48749160874431E-06 )*y-
                1.81353179793672E-05 )*y+1.14504948737066E-04 )*y-
              6.10614987696677E-04 )*y+2.64584212770942E-03 )*y-
            8.66415899015349E-03 )*y+1.75257821619922E-02;
            let e = (-x).exp();
            let f1 = ((x+x)*f2+e)/3.0E+00;
            ww1 = (x+x)*f1+e;
            let t1 = rt1/(rt1+1.0E+00);
            let t2 = rt2/(rt2+1.0E+00);
            let t3 = rt3/(rt3+1.0E+00);
            let a2 = f2-t1*f1;
            let a1 = f1-t1*ww1;
            ww3 = (a2-t2*a1)/((t3-t2)*(t3-t1));
            ww2 = (t3*a1-a2)/((t3-t2)*(t2-t1));
            ww1 = ww1-ww2-ww3;
        }
    } else if x < 10.0 {
        let e = (-x).exp();
        ww1 = (((((( 4.6897511375022E-01/x-6.9955602298985E-01)/x +
               5.3689283271887E-01)/x-3.2883030418398E-01)/x +
             2.4645596956002E-01)/x-4.9984072848436E-01)/x -
           3.1501078774085E-06)*e + (PIE4/x).sqrt();
        let f1 = (ww1-e)/(x+x);
        if n == 1 {
            rt1 = f1/(ww1-f1);
        } else if n == 2 {
            let y = x-7.5E+00;
            rt1 = (((((((((((((-1.43632730148572E-16*y+2.38198922570405E-16)*
                        y+1.358319618800E-14)*y-7.064522786879E-14)*y-
                      7.719300212748E-13)*y+7.802544789997E-12)*y+
                    6.628721099436E-11)*y-1.775564159743E-09)*y+
                  1.713828823990E-08)*y-1.497500187053E-07)*y+
                2.283485114279E-06)*y-3.76953869614706E-05 )*y+
              4.74791204651451E-04 )*y-4.60448960876139E-03 )*y+
            3.72458587837249E-02;
            rt2 = (((((((((((( 2.48791622798900E-14*y-1.36113510175724E-13)*y-
                       2.224334349799E-12)*y+4.190559455515E-11)*y-
                     2.222722579924E-10)*y-2.624183464275E-09)*y+
                   6.128153450169E-08)*y-4.383376014528E-07)*y-
                 2.49952200232910E-06 )*y+1.03236647888320E-04 )*y-
               1.44614664924989E-03 )*y+1.35094294917224E-02 )*y-
             9.53478510453887E-02 )*y+5.44765245686790E-01;
            ww2 = ((f1-ww1)*rt1+f1)*(1.0E+00+rt2)/(rt2-rt1);
            ww1 = ww1-ww2;
        } else if n == 3 {
            let f2 = (f1+f1+f1-e)/(x+x);
            let y = x-7.5E+00;
            rt1 = ((((((((((( 5.74429401360115E-16*y+7.11884203790984E-16)*y-
                      6.736701449826E-14)*y-6.264613873998E-13)*y+
                    1.315418927040E-11)*y-4.23879635610964E-11 )*y+
                  1.39032379769474E-09 )*y-4.65449552856856E-08 )*y+
                7.34609900170759E-07 )*y-1.08656008854077E-05 )*y+
              1.77930381549953E-04 )*y-2.39864911618015E-03 )*y+
            2.39112249488821E-02;
            rt2 = ((((((((((( 1.13464096209120E-14*y+6.99375313934242E-15)*y-
                      8.595618132088E-13)*y-5.293620408757E-12)*y-
                    2.492175211635E-11)*y+2.73681574882729E-09 )*y-
                  1.06656985608482E-08 )*y-4.40252529648056E-07 )*y+
                9.68100917793911E-06 )*y-1.68211091755327E-04 )*y+
              2.69443611274173E-03 )*y-3.23845035189063E-02 )*y+
            2.75969447451882E-01;
            rt3 = (((((((((((( 6.66339416996191E-15*y+1.84955640200794E-13)*y-
                       1.985141104444E-12)*y-2.309293727603E-11)*y+
                     3.917984522103E-10)*y+1.663165279876E-09)*y-
                   6.205591993923E-08)*y+8.769581622041E-09)*y+
                 8.97224398620038E-06 )*y-3.14232666170796E-05 )*y-
               1.83917335649633E-03 )*y+3.51246831672571E-02 )*y-
             3.22335051270860E-01 )*y+1.73582831755430E+00;
            let t1 = rt1/(rt1+1.0E+00);
            let t2 = rt2/(rt2+1.0E+00);
            let t3 = rt3/(rt3+1.0E+00);
            let a2 = f2-t1*f1;
            let a1 = f1-t1*ww1;
            ww3 = (a2-t2*a1)/((t3-t2)*(t3-t1));
            ww2 = (t3*a1-a2)/((t3-t2)*(t2-t1));
            ww1 = ww1-ww2-ww3;
        }
    } else if x < 15.0 {
        let e = (-x).exp();
        ww1 = (((-1.8784686463512E-01/x+2.2991849164985E-01)/x -
            4.9893752514047E-01)/x-2.1916512131607E-05)*e
          + (PIE4/x).sqrt();
        let f1 = (ww1-e)/(x+x);
        if n == 1 {
            rt1 = f1/(ww1-f1);
        } else if n == 2 {
            rt1 = ((((-1.01041157064226E-05*x+1.19483054115173E-03)*x -
                   6.73760231824074E-02)*x+1.25705571069895E+00)*x +
                 (((-8.57609422987199E+03/x+5.91005939591842E+03)/x -
                   1.70807677109425E+03)/x+2.64536689959503E+02)/x -
                 2.38570496490846E+01)*e + R12/(x-R12);
            rt2 = ((( 3.39024225137123E-04*x-9.34976436343509E-02)*x -
                  4.22216483306320E+00)*x +
                 (((-2.08457050986847E+03/x -
                    1.04999071905664E+03)/x+3.39891508992661E+02)/x -
                  1.56184800325063E+02)/x+8.00839033297501E+00)*e + R22/(x-R22);
            ww2 = ((f1-ww1)*rt1+f1)*(1.0E+00+rt2)/(rt2-rt1);
            ww1 = ww1-ww2;
        } else if n == 3 {
            let f2 = (f1+f1+f1-e)/(x+x);
            let y = x-12.5E+00;
            rt1 = ((((((((((( 4.42133001283090E-16*y-2.77189767070441E-15)*y-
                      4.084026087887E-14)*y+5.379885121517E-13)*y+
                    1.882093066702E-12)*y-8.67286219861085E-11 )*y+
                  7.11372337079797E-10 )*y-3.55578027040563E-09 )*y+
                1.29454702851936E-07 )*y-4.14222202791434E-06 )*y+
              8.04427643593792E-05 )*y-1.18587782909876E-03 )*y+
            1.53435577063174E-02;
            rt2 = ((((((((((( 6.85146742119357E-15*y-1.08257654410279E-14)*y-
                      8.579165965128E-13)*y+6.642452485783E-12)*y+
                    4.798806828724E-11)*y-1.13413908163831E-09 )*y+
                  7.08558457182751E-09 )*y-5.59678576054633E-08 )*y+
                2.51020389884249E-06 )*y-6.63678914608681E-05 )*y+
              1.11888323089714E-03 )*y-1.45361636398178E-02 )*y+
            1.65077877454402E-01;
            rt3 = (((((((((((( 3.20622388697743E-15*y-2.73458804864628E-14)*y-
                       3.157134329361E-13)*y+8.654129268056E-12)*y-
                     5.625235879301E-11)*y-7.718080513708E-10)*y+
                   2.064664199164E-08)*y-1.567725007761E-07)*y-
                 1.57938204115055E-06 )*y+6.27436306915967E-05 )*y-
               1.01308723606946E-03 )*y+1.13901881430697E-02 )*y-
             1.01449652899450E-01 )*y+7.77203937334739E-01;
            let t1 = rt1/(rt1+1.0E+00);
            let t2 = rt2/(rt2+1.0E+00);
            let t3 = rt3/(rt3+1.0E+00);
            let a2 = f2-t1*f1;
            let a1 = f1-t1*ww1;
            ww3 = (a2-t2*a1)/((t3-t2)*(t3-t1));
            ww2 = (t3*a1-a2)/((t3-t2)*(t2-t1));
            ww1 = ww1-ww2-ww3;
        }
    } else if x < 33.0 {
        let e = (-x).exp();
        ww1 = (( 1.9623264149430E-01/x-4.9695241464490E-01)/x -
           6.0156581186481E-05)*e + (PIE4/x).sqrt();
        let f1 = (ww1-e)/(x+x);
        if n == 1 {
            rt1 = f1/(ww1-f1);
        } else if n == 2 {
            rt1 = ((((-1.14906395546354E-06*x+1.76003409708332E-04)*x -
                   1.71984023644904E-02)*x-1.37292644149838E-01)*x +
                 (-4.75742064274859E+01/x+9.21005186542857E+00)/x -
                 2.31080873898939E-02)*e + R12/(x-R12);
            rt2 = ((( 3.64921633404158E-04*x-9.71850973831558E-02)*x -
                  4.02886174850252E+00)*x +
                 (-1.35831002139173E+02/x -
                  8.66891724287962E+01)/x+2.98011277766958E+00)*e + R22/(x-R22);
            ww2 = ((f1-ww1)*rt1+f1)*(1.0E+00+rt2)/(rt2-rt1);
            ww1 = ww1-ww2;
        } else if n == 3 {
            let f2 = (f1+f1+f1-e)/(x+x);
            if x < 20.0 {
                rt1 = ((((((-2.43270989903742E-06*x+3.57901398988359E-04)*x -
                       2.34112415981143E-02)*x+7.81425144913975E-01)*x -
                     1.73209218219175E+01)*x+2.43517435690398E+02)*x +
                   (-1.97611541576986E+04/x+9.82441363463929E+03)/x -
                   2.07970687843258E+03)*e + R13/(x-R13);
                rt2 = (((((-2.62627010965435E-04*x+3.49187925428138E-02)*x -
                      3.09337618731880E+00)*x+1.07037141010778E+02)*x -
                    2.36659637247087E+03)*x +
                   ((-2.91669113681020E+06/x +
                     1.41129505262758E+06)/x-2.91532335433779E+05)/x +
                   3.35202872835409E+04)*e + R23/(x-R23);
                rt3 = ((((( 9.31856404738601E-05*x-2.87029400759565E-02)*x -
                      7.83503697918455E-01)*x-1.84338896480695E+01)*x +
                    4.04996712650414E+02)*x +
                   (-1.89829509315154E+05/x +
                    5.11498390849158E+04)/x-6.88145821789955E+03)*e
              + R33/(x-R33);
            } else {
                rt1 = ((((-4.97561537069643E-04*x-5.00929599665316E-02)*x +
                     1.31099142238996E+00)*x-1.88336409225481E+01)*x -
                   6.60344754467191E+02 /x+1.64931462413877E+02)*e
              + R13/(x-R13);
                rt2 = ((((-4.48218898474906E-03*x-5.17373211334924E-01)*x +
                     1.13691058739678E+01)*x-1.65426392885291E+02)*x -
                   6.30909125686731E+03 /x+1.52231757709236E+03)*e
              + R23/(x-R23);
                rt3 = ((((-1.38368602394293E-02*x-1.77293428863008E+00)*x +
                     1.73639054044562E+01)*x-3.57615122086961E+02)*x -
                   1.45734701095912E+04 /x+2.69831813951849E+03)*e
              + R33/(x-R33);
            }
            let t1 = rt1/(rt1+1.0E+00);
            let t2 = rt2/(rt2+1.0E+00);
            let t3 = rt3/(rt3+1.0E+00);
            let a2 = f2-t1*f1;
            let a1 = f1-t1*ww1;
            ww3 = (a2-t2*a1)/((t3-t2)*(t3-t1));
            ww2 = (t3*a1-a2)/((t3-t2)*(t2-t1));
            ww1 = ww1-ww2-ww3;
        }
    } else {
        ww1 = (PIE4/x).sqrt();
        if n == 1 {
            rt1 = 0.5E+00/(x-0.5E+00);
        } else if n == 2 {
            if x < 40.0 {
                let e = (-x).exp();
                rt1 = (-8.78947307498880E-01*x+1.09243702330261E+01)*e
              + R12/(x-R12);
                rt2 = (-9.28903924275977E+00*x+8.10642367843811E+01)*e
              + R22/(x-R22);
                ww2 = ( 4.46857389308400E+00*x-7.79250653461045E+01)*e + W22*ww1;
                ww1 = ww1-ww2;
            } else {
                rt1 = R12/(x-R12);
                rt2 = R22/(x-R22);
                ww2 = W22*ww1;
                ww1 = ww1-ww2;
            }
        } else if n == 3 {
            if x < 47.0 {
                let e = (-x).exp();
                rt1 = ((-7.39058467995275E+00*x+3.21318352526305E+02)*x -
                   3.99433696473658E+03)*e + R13/(x-R13);
                rt2 = ((-7.38726243906513E+01*x+3.13569966333873E+03)*x -
                   3.86862867311321E+04)*e + R23/(x-R23);
                rt3 = ((-2.63750565461336E+02*x+1.04412168692352E+04)*x -
                   1.28094577915394E+05)*e + R33/(x-R33);
                ww3 = ((( 1.52258947224714E-01*x-8.30661900042651E+00)*x +
                    1.92977367967984E+02)*x-1.67787926005344E+03)*e
              + W33*ww1;
                ww2 = (( 6.15072615497811E+01*x-2.91980647450269E+03)*x +
                   3.80794303087338E+04)*e + W23*ww1;
                ww1 = ww1-ww2-ww3;
            } else {
                rt1 = R13/(x-R13);
                rt2 = R23/(x-R23);
                rt3 = R33/(x-R33);
                ww2 = W23*ww1;
                ww3 = W33*ww1;
                ww1 = ww1-ww2-ww3;
            }
        }
    }

    roots[0] = rt1;
    weights[0] = ww1;
    if n > 1 {
        roots[1] = rt2;
        weights[1] = ww2;
    }
    if n > 2 {
        roots[2] = rt3;
        weights[2] = ww3;
    }
}
